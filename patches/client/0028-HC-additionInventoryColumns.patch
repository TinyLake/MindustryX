From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: way-zer <himc.wicp@gmail.com>
Date: Sun, 18 Feb 2024 15:58:00 +0800
Subject: [PATCH] HC: additionInventoryColumns

---
 core/src/mindustry/ui/dialogs/PlanetDialog.java             | 6 ++++--
 core/src/mindustry/ui/fragments/BlockInventoryFragment.java | 2 +-
 core/src/mindustry/world/blocks/ItemSelection.java          | 3 ++-
 3 files changed, 7 insertions(+), 4 deletions(-)

diff --git a/core/src/mindustry/ui/dialogs/PlanetDialog.java b/core/src/mindustry/ui/dialogs/PlanetDialog.java
index c252d74b6c77917c94febcaee5685274b3f5c2bc..3f671f948eb3be11d7ebe461c78f9cadbd302996 100644
--- a/core/src/mindustry/ui/dialogs/PlanetDialog.java
+++ b/core/src/mindustry/ui/dialogs/PlanetDialog.java
@@ -1027,6 +1027,7 @@ public class PlanetDialog extends BaseDialog implements PlanetInterfaceRenderer{
         Table t = new Table().left();
 
         int i = 0;
+        int columns = 3 + mindustryX.VarsX.additionInventoryColumns.get();
         for(var item : content.items()){
             var stat = stats.get(item);
             if(stat == null) continue;
@@ -1034,7 +1035,7 @@ public class PlanetDialog extends BaseDialog implements PlanetInterfaceRenderer{
             if(total > 1){
                 t.image(item.uiIcon).padRight(3);
                 t.add(UI.formatAmount(total) + " " + Core.bundle.get("unit.perminute")).color(Color.lightGray).padRight(3);
-                if(++i % 3 == 0){
+                if(++i % columns == 0){
                     t.row();
                 }
             }
@@ -1121,10 +1122,11 @@ public class PlanetDialog extends BaseDialog implements PlanetInterfaceRenderer{
                     t.table(res -> {
 
                         int i = 0;
+                        int columns = 4 + mindustryX.VarsX.additionInventoryColumns.get();
                         for(ItemStack stack : items){
                             res.image(stack.item.uiIcon).padRight(3);
                             res.add(UI.formatAmount(Math.max(stack.amount, 0))).color(Color.lightGray);
-                            if(++i % 4 == 0){
+                            if(++i % columns == 0){
                                 res.row();
                             }
                         }
diff --git a/core/src/mindustry/ui/fragments/BlockInventoryFragment.java b/core/src/mindustry/ui/fragments/BlockInventoryFragment.java
index 54a36cde6eee102c9c8f3bfd5e4c76a2f4d0f1e1..dc3fefe34cd41290c432965811a6c85f0c5727f5 100644
--- a/core/src/mindustry/ui/fragments/BlockInventoryFragment.java
+++ b/core/src/mindustry/ui/fragments/BlockInventoryFragment.java
@@ -138,7 +138,7 @@ public class BlockInventoryFragment{
             }
         });
 
-        int cols = 3;
+        int cols = 3 + mindustryX.VarsX.additionInventoryColumns.get();
         int row = 0;
 
         table.margin(4f);
diff --git a/core/src/mindustry/world/blocks/ItemSelection.java b/core/src/mindustry/world/blocks/ItemSelection.java
index 6bbe2ba127c5f3126bd7c42badea0a1d86d15db3..eafa13692bc52e2b49722d836e39286caeced785 100644
--- a/core/src/mindustry/world/blocks/ItemSelection.java
+++ b/core/src/mindustry/world/blocks/ItemSelection.java
@@ -47,13 +47,14 @@ public class ItemSelection{
         buildTable(null, table, items, holder, consumer, true, rows, columns);
     }
 
-    public static <T extends UnlockableContent> void buildTable(@Nullable Block block, Table table, Seq<T> items, Prov<T> holder, Cons<T> consumer, boolean closeSelect, int rows, int columns){
+    public static <T extends UnlockableContent> void buildTable(@Nullable Block block, Table table, Seq<T> items, Prov<T> holder, Cons<T> consumer, boolean closeSelect, int rows, int columns0){
         ButtonGroup<ImageButton> group = new ButtonGroup<>();
         group.setMinCheckCount(0);
         Table cont = new Table().top();
         cont.defaults().size(40);
 
         if(search != null) search.clearText();
+        int columns = columns0 + mindustryX.VarsX.additionInventoryColumns.get();
 
         Runnable rebuild = () -> {
             group.clear();
